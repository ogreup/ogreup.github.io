<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>关于Git在Windows平台的core.autocrlf参数 | Ogreup's TechNote</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">关于Git在Windows平台的core.autocrlf参数</h1><a id="logo" href="/.">Ogreup's TechNote</a><p class="description">一个软件攻城狮的所做所想，以及踩坑经验分享</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">关于Git在Windows平台的core.autocrlf参数</h1><div class="post-meta">Sep 9, 2017</div><a data-disqus-identifier="2017/09/09/关于git在windows平台的core-autocrlf参数/" href="/2017/09/09/关于git在windows平台的core-autocrlf参数/#disqus_thread" class="disqus-comment-count"></a><div class="post-content"><p>按照我的理解，如果设置core.autocrlf为true，在commit时会将“CRLF”换行符转为“LF”保存在仓库，checkout时又转换回来。然而实际测试似乎不是这么回事。百思不得姐。</p>
<a id="more"></a>
<h2 id="core-autocrlf参数的官方帮助说明"><a href="#core-autocrlf参数的官方帮助说明" class="headerlink" title="core.autocrlf参数的官方帮助说明"></a>core.autocrlf参数的官方帮助说明</h2><p>根据《Pro Git》，</p>
<blockquote>
<p>core.autocrlf<br>假如你正在 Windows 上写程序，而你的同伴用的是其他系统（或相反），你可能会遇到 CRLF 问题。这是因为Windows 使用回车（CR）和换行（LF）两个字符来结束一行，而 Mac 和 Linux 只使用换行LF）一个字符。虽然这是小问题，但它会极大地扰乱跨平台协作。许多 Windows 上的编辑器会悄悄把行尾的换行字符转换成回车和换行，或在用户按下 Enter 键时，插入回车和换行两个字符。</p>
<p>Git 可以在你提交时自动地把回车和换行转换成换行，而在检出代码时把换行转换成回车和换行。你可以用core.autocrlf 来打开此项功能。如果是在 Windows 系统上，把它设置成 true，这样在检出代码时，换行会被转换成回车和换行：</p>
</blockquote>
<p>git自带帮助的说法不是很直接，基本意思该还是和上面的说法不矛盾，</p>
<blockquote>
<p>core.autocrlf<br>Setting this variable to “true” is the same as setting the text attribute to “auto” on all files and core.eol to “crlf”. Set to true if you want to have CRLF line endings in your working directory and the repository has LF line endings. This variable can be set to input, in which case no output conversion is performed.</p>
</blockquote>
<p>按照我的理解，如果设置core.autocrlf为true，在commit时会将“CRLF”换行符转为“LF”保存在仓库，checkout时又转换回来。仓库中始终使用“LF”换行，工作区中始终使用“CRLF”换行。下面看看实际测试的结果。</p>
<h2 id="测试情况"><a href="#测试情况" class="headerlink" title="测试情况"></a>测试情况</h2><p>xxx目录下包含read.win和read.unix两个文本文件，内容“相同”（仅换行风格不同，分别为“CRLF”和“LF”）。首先创建git仓库。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">paul<span class="meta">@paul</span>-PC MINGW64 <span class="regexp">/e/</span>xxx</div><div class="line">$ git init</div><div class="line">Initialized empty Git repository <span class="keyword">in</span> <span class="string">E:</span><span class="regexp">/xxx/</span>.git/</div></pre></td></tr></table></figure>
<p>查询当前设置，core.autocrlf已设置为true（Windows平台下的默认值）。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">paul@paul-PC MINGW64 /e/xxx (master)</div><div class="line">$ git<span class="built_in"> config </span>--list</div><div class="line">core.<span class="attribute">symlinks</span>=<span class="literal">false</span></div><div class="line">core.<span class="attribute">autocrlf</span>=<span class="literal">true</span></div><div class="line">core.<span class="attribute">fscache</span>=<span class="literal">true</span></div><div class="line">core.<span class="attribute">repositoryformatversion</span>=0</div><div class="line">core.<span class="attribute">filemode</span>=<span class="literal">false</span></div><div class="line">core.<span class="attribute">bare</span>=<span class="literal">false</span></div><div class="line">core.<span class="attribute">logallrefupdates</span>=<span class="literal">true</span></div><div class="line">core.<span class="attribute">symlinks</span>=<span class="literal">false</span></div><div class="line">core.<span class="attribute">ignorecase</span>=<span class="literal">true</span></div></pre></td></tr></table></figure>
<p>添加当前目录到staging aera并提交，给出的提示是read.unix中的“LF”将被转换为“CRLF”，这与我的预期（read.win中的“CRLF”转换为“LF”，read.unix保持不变）相反。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">paul@paul-PC MINGW64 /e/xxx (master)</div><div class="line">$ git add .</div><div class="line">warning: LF will be replaced by CRLF in read.unix.</div><div class="line">The file will have its original line endings in your working directory.</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (master)</div><div class="line">$ git <span class="keyword">commit</span> -m <span class="string">"initial"</span></div><div class="line">[<span class="keyword">master</span> (root-<span class="keyword">commit</span>) <span class="number">7</span>eb8f08] <span class="keyword">initial</span></div><div class="line"> <span class="number">2</span> files <span class="keyword">changed</span>, <span class="number">6</span> insertions(+)</div><div class="line"> <span class="keyword">create</span> <span class="keyword">mode</span> <span class="number">100644</span> read.unix</div><div class="line"> <span class="keyword">create</span> <span class="keyword">mode</span> <span class="number">100644</span> read.win</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git <span class="keyword">status</span></div><div class="line"><span class="keyword">On</span> branch <span class="keyword">master</span></div><div class="line"><span class="keyword">nothing</span> <span class="keyword">to</span> <span class="keyword">commit</span>, working tree clean</div></pre></td></tr></table></figure>
<p>使用Git Windows安装包中自带的dos2unix将read.win文件换行符转换为“LF”，status命令检测到了文件变化，diff命令给出了提示，但执行commit时，git表示没有需要提交的内容（此时使用NotePad++打开read.win进行验证，换行符确实已转换为unix风格）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">paul@paul-PC MINGW64 /e/xxx (master)</div><div class="line">$ dos2unix.exe read.win</div><div class="line">dos2unix: converting file read.win to Unix format...</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (master)</div><div class="line">$ git status</div><div class="line">On branch master</div><div class="line">Changes not staged for <span class="keyword">commit</span>:</div><div class="line">  (<span class="keyword">use</span> <span class="string">"git add &lt;file&gt;..."</span> <span class="keyword">to</span> <span class="keyword">update</span> what will be committed)</div><div class="line">  (<span class="keyword">use</span> <span class="string">"git checkout -- &lt;file&gt;..."</span> <span class="keyword">to</span> discard changes <span class="keyword">in</span> working <span class="keyword">directory</span>)</div><div class="line"></div><div class="line">        modified:   read.win</div><div class="line"></div><div class="line"><span class="keyword">no</span> changes added <span class="keyword">to</span> <span class="keyword">commit</span> (<span class="keyword">use</span> <span class="string">"git add"</span> <span class="keyword">and</span>/<span class="keyword">or</span> <span class="string">"git commit -a"</span>)</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git diff</div><div class="line"><span class="keyword">warning</span>: LF will be replaced <span class="keyword">by</span> CRLF <span class="keyword">in</span> read.win.</div><div class="line">The <span class="keyword">file</span> will have its original line endings <span class="keyword">in</span> your working directory.</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git <span class="keyword">add</span> .</div><div class="line"><span class="keyword">warning</span>: LF will be replaced <span class="keyword">by</span> CRLF <span class="keyword">in</span> read.win.</div><div class="line">The <span class="keyword">file</span> will have its original line endings <span class="keyword">in</span> your working directory.</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git <span class="keyword">commit</span> -m <span class="string">"change eol to lf in read.win"</span></div><div class="line"><span class="keyword">On</span> branch <span class="keyword">master</span></div><div class="line"><span class="keyword">nothing</span> <span class="keyword">to</span> <span class="keyword">commit</span>, working tree clean</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git <span class="keyword">log</span></div><div class="line"><span class="keyword">commit</span> <span class="number">7</span>eb8f08b1f16b68cc8e41eefc4d51fb4757cf505 (<span class="keyword">HEAD</span> -&gt; <span class="keyword">master</span>)</div><div class="line">Author: paul &lt;orgeup@gmail.com&gt;</div><div class="line"><span class="built_in">Date</span>:   Thu Sep <span class="number">7</span> <span class="number">11</span>:<span class="number">29</span>:<span class="number">39</span> <span class="number">2017</span> +<span class="number">0800</span></div><div class="line"></div><div class="line">    <span class="keyword">initial</span></div></pre></td></tr></table></figure>
<p>使用NotePad++，将read.unix换行符由unix风格转换为dos风格，status命令检测到了文件变化，diff/status未提示。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">paul@paul-PC MINGW64 /e/xxx (master)</div><div class="line">$ git status</div><div class="line">On branch master</div><div class="line">Changes not staged for <span class="keyword">commit</span>:</div><div class="line">  (<span class="keyword">use</span> <span class="string">"git add &lt;file&gt;..."</span> <span class="keyword">to</span> <span class="keyword">update</span> what will be committed)</div><div class="line">  (<span class="keyword">use</span> <span class="string">"git checkout -- &lt;file&gt;..."</span> <span class="keyword">to</span> discard changes <span class="keyword">in</span> working <span class="keyword">directory</span>)</div><div class="line"></div><div class="line">        modified:   read.unix</div><div class="line"></div><div class="line"><span class="keyword">no</span> changes added <span class="keyword">to</span> <span class="keyword">commit</span> (<span class="keyword">use</span> <span class="string">"git add"</span> <span class="keyword">and</span>/<span class="keyword">or</span> <span class="string">"git commit -a"</span>)</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git diff</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git <span class="keyword">add</span> read.unix</div><div class="line"></div><div class="line">paul@paul-PC MINGW64 /e/xxx (<span class="keyword">master</span>)</div><div class="line">$ git <span class="keyword">status</span></div><div class="line"><span class="keyword">On</span> branch <span class="keyword">master</span></div><div class="line"><span class="keyword">nothing</span> <span class="keyword">to</span> <span class="keyword">commit</span>, working tree clean</div></pre></td></tr></table></figure>
<p>Windows平台下的开发工具（VS2010， QtCreator），似乎都没有设置文本编辑器换行风格的选项，有点小纠结。</p>
</div><div class="tags"><a href="/tags/折腾/">折腾</a><a href="/tags/git/">git</a></div><div class="post-nav"><a href="/2017/09/06/git无法使用socks5代理/" class="next">git无法使用socks5代理</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'ogreup';
var disqus_identifier = '2017/09/09/关于git在windows平台的core-autocrlf参数/';
var disqus_title = '关于Git在Windows平台的core.autocrlf参数';
var disqus_url = 'https://ogreup.github.io/2017/09/09/关于git在windows平台的core-autocrlf参数/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/next/config.json',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//ogreup.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://ogreup.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/折腾/" style="font-size: 15px;">折腾</a> <a href="/tags/osg/" style="font-size: 15px;">osg</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/mpl/" style="font-size: 15px;">mpl</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/software/" style="font-size: 15px;">software</a> <a href="/tags/ss/" style="font-size: 15px;">ss</a> <a href="/tags/踩坑/" style="font-size: 15px;">踩坑</a> <a href="/tags/qt/" style="font-size: 15px;">qt</a> <a href="/tags/programming/" style="font-size: 15px;">programming</a> <a href="/tags/windows/" style="font-size: 15px;">windows</a> <a href="/tags/android/" style="font-size: 15px;">android</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/09/关于git在windows平台的core-autocrlf参数/">关于Git在Windows平台的core.autocrlf参数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/06/git无法使用socks5代理/">git无法使用socks5代理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/20/thinkpad-t460安装windows7/">Thinkpad T460安装Windows7</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/07/numpy中loadtxt-genfromtxt的一些不一致性/">numpy中loadtxt/genfromtxt的一些不一致性</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/02/Windows7配置Qt5-7-1开发环境/">Windows7配置Qt5.7.1开发环境</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/16/Fedora25安装YouCompleteMe/">Fedora25安装YouCompleteMe</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/04/第一个Android应用/">第一个Android应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/20/关于API命名/">关于API命名</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/20/关于tinyxml的“奇怪”问题/">关于tinyxml的“奇怪”问题</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//ogreup.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">Ogreup's TechNote.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>